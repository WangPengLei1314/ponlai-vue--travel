webpackJsonp([1],{0:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7+uW"),a=s("zL8q"),n=s.n(a),o=(s("tvR6"),s("PGL6"),s("Dd8w")),r=s.n(o),l=s("NYxO"),c={data:function(){return{isshow:!0,message:{cityEn:"shanghai",cityCn:"上海",getType:""}}},mounted:function(){this.router()},computed:r()({},Object(l.b)({loading:function(t){return t.loading}})),methods:{getCityName:function(t){this.message.cityEn=t.cityEn,this.message.cityCn=t.cityCn},getType:function(t){this.message.getType=t},router:function(){"/"!=this.$route.path?this.isshow=!1:this.isshow=!0}},watch:{$route:"router"}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app"},[s("div",{staticClass:"wrapper"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],attrs:{id:"loading"}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"loading",attrs:{"element-loading-background":"rgba(255, 255, 255, 0.8)"}})]),t._v(" "),s("div",{staticClass:"header"},[t.isshow?s("span",[s("router-link",{attrs:{to:{path:"/city"}}},[t._v(t._s(t.message.cityCn)),s("i",{staticClass:"el-icon-arrow-down"})])],1):s("span",{staticClass:"backpage",on:{click:function(e){t.$router.back(-1)}}},[s("i",{staticClass:"el-icon-arrow-left"})]),t._v("\n        同城旅游\n        "),s("div",{staticClass:"home-btn"},[s("router-link",{attrs:{to:{path:"/"}}},[s("i",{staticClass:"iconfont icon-home"})])],1)]),t._v(" "),s("keep-alive",[s("router-view",t._b({on:{cityName:t.getCityName,getType:t.getType}},"router-view",t.message,!1))],1)],1)])},staticRenderFns:[]};var d=s("VU/8")(c,u,!1,function(t){s("kEhB")},null,null).exports,p=s("/ocq"),h={props:{cityEn:String},data:function(){return{typelists:{"音乐":"music","戏剧":"drama","展览":"exhibition","讲座":"salon","聚会":"party","运动":"sports","旅行":"travel","公益":"commonweal","电影":"film","全部":"all"},result:"",type:""}},created:function(){this.hotList()},methods:{hotList:function(){var t=this;this.$http.jsonp("https://api.douban.com/v2/event/list",{params:{loc:this.cityEn,count:100}}).then(function(e){e.data.events.sort(function(t,e){return e.wisher_count-t.wisher_count});for(var s=[],i=0;i<19;i++)s.push(e.data.events[i]);t.result=s},function(t){console.log(t)})},toTypeList:function(t){this.$emit("getType",t),this.$router.push({name:"TypeList",query:{type:t}})}},watch:{cityEn:function(){this.hotList()}}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"indexContent"},[t._m(0),t._v(" "),s("div",{staticClass:"typeList"},[s("ul",t._l(t.typelists,function(e,i,a){return s("li",{on:{click:function(s){t.toTypeList(e)}}},[s("img",{attrs:{src:"./static/img/list-"+(a+1)+".png"}}),s("span",[t._v(t._s(i))])])}))]),t._v(" "),s("div",{staticClass:"indexList"},[s("h1",[t._v("人气推荐")]),t._v(" "),s("ol",t._l(t.result,function(e,i){return s("li",[s("router-link",{attrs:{to:{path:"/detail/"+t.result[i].id,params:{id:t.result[i].id}}}},[s("div",{staticClass:"list-wrap"},[s("div",{staticClass:"list-left"},[s("img",{attrs:{src:t.result[i].image}})]),t._v(" "),s("div",{staticClass:"list-right"},[s("h2",[t._v(t._s(t.result[i].title))]),t._v(" "),s("p",[t._v("时间："+t._s(t.result[i].time_str))]),t._v(" "),s("p",[t._v("地点："+t._s(t.result[i].address))]),t._v(" "),s("span",{staticClass:"price"},[t._v("费用："+t._s(t.result[i].fee_str))]),s("span",{staticClass:"Interest"},[t._v(t._s(t.result[i].wisher_count)+" 人参加")])])])])],1)})),t._v(" "),s("div",{staticClass:"allDetailList",on:{click:function(e){t.toTypeList("all")}}},[s("span",[t._v("查看全部")]),s("i",{staticClass:"el-icon-arrow-right"})])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"banner"},[e("img",{attrs:{src:s("Yz7+")}})])}]};var f=s("VU/8")(h,v,!1,function(t){s("ngOA")},"data-v-8bca4028",null).exports,y={props:{cityEn:String,getType:String},data:function(){return{result:[],category:"",categoryLable:[{name:"categoryFirst",categoryOption:{default:"吃喝玩乐",all:"全部",music:"音乐",drama:"戏剧",exhibition:"展览",salon:"讲座",party:"聚会",sports:"运动",travel:"旅行",commonweal:"公益",film:"电影"},selectNum:0},{name:"categorySecond",categoryOption:{default:"智能排序",today:"今天",tomorrow:"明天",weekend:"周末",week:"最近一周"},selectNum:0},{name:"categoryThird",categoryOption:{default:"其他筛选",ongoing:"正在进行",expired:"已过期"},selectNum:0}],filter:{type:this.getType,day:"default",status:"default"},scrollStyle:{position:"relative",margin:"0"},shade:"",num:0}},mounted:function(){window.addEventListener("scroll",this.scrollFunc)},created:function(){this.getData(this.filter.type,this.filter.day,this.filter.status)},methods:{getData:function(t,e,s){var i=this;this.$http.jsonp("https://api.douban.com/v2/event/list",{params:{loc:this.cityEn,type:t,day_type:e,status:s}}).then(function(t){i.result=t.data.events},function(t){console.log(t)})},onFilter:function(){this.shade="shade"},unShade:function(){this.category="",this.shade=""},changeOption:function(t,e,s,i){switch(this.categoryLable[t].selectNum=i,this.categoryLable[t].categoryOption.default=e,this.unShade(),t){case 0:this.filter.type=s;break;case 1:this.filter.day=s;break;case 2:this.filter.status=s}this.num=0,this.changeFilter()},scrollData:function(t,e,s,i){var a=this;this.$http.jsonp("https://api.douban.com/v2/event/list",{params:{loc:this.cityEn,type:t,day_type:e,status:s,start:i}}).then(function(t){for(var e in t.data.events)a.result.push(t.data.events[e])},function(t){console.log(t)})},scrollFunc:function(){var t=this,e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,s=document.documentElement.clientHeight||document.body.clientHeight,i=document.body.offsetHeight;e>50?(this.scrollStyle.position="fixed",this.scrollStyle.margin="50px 0 0 0"):(this.scrollStyle.position="relative",this.scrollStyle.margin="0"),e+s==i&&(this.num++,setTimeout(function(){t.scrollData(t.filter.type,t.filter.day,t.filter.status,t.num)},0))},changeFilter:function(){this.$router.push({name:"TypeList",query:{type:this.filter.type,day:this.filter.day,status:this.filter.status}}),this.getData(this.filter.type,this.filter.day,this.filter.status,this.num)}},destroyed:function(){window.removeEventListener("scroll",this.scrollFunc)},watch:{getType:function(){this.filter.type=this.getType,this.getData(this.filter.type,this.filter.day,this.filter.status)},cityEn:function(){this.filter.type=this.getType,this.getData(this.filter.type,this.filter.day,this.filter.status)}}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"detaillist"},[s("div",{staticClass:"detaillistnav",style:"position:"+t.scrollStyle.position},[s("el-tabs",{on:{"tab-click":t.onFilter},model:{value:t.category,callback:function(e){t.category=e},expression:"category"}},t._l(t.categoryLable,function(e,i){return s("el-tab-pane",{key:t.categoryLable[i].categoryOption.default,attrs:{label:t.categoryLable[i].categoryOption.default,name:t.categoryLable[i].name}},t._l(t.categoryLable[i].categoryOption,function(e,a,n){return n>0?s("div",{key:e,staticClass:"categoryOption",class:{select:n==t.categoryLable[i].selectNum},on:{click:function(s){t.changeOption(i,e,a,n)}}},[t._v(t._s(e))]):t._e()}))}))],1),t._v(" "),s("div",{class:t.shade,on:{click:function(e){t.unShade()}}}),t._v(" "),s("div",{staticClass:"typeList",style:"margin:"+t.scrollStyle.margin},[s("ol",t._l(t.result,function(e,i){return s("li",[s("router-link",{attrs:{to:{path:"/detail/"+t.result[i].id,params:{id:t.result[i].id}}}},[s("div",{staticClass:"list-wrap"},[s("div",{staticClass:"list-left"},[s("img",{attrs:{src:t.result[i].image}})]),t._v(" "),s("div",{staticClass:"list-right"},[s("h2",[t._v(t._s(t.result[i].title))]),t._v(" "),s("p",[t._v("时间："+t._s(t.result[i].time_str))]),t._v(" "),s("p",[t._v("地点："+t._s(t.result[i].address))]),t._v(" "),s("span",{staticClass:"price"},[t._v("费用："+t._s(t.result[i].fee_str))]),s("span",{staticClass:"Interest"},[t._v(t._s(t.result[i].wisher_count)+" 人参加")])])])])],1)}))])])},staticRenderFns:[]};var g=s("VU/8")(y,m,!1,function(t){s("cBJ7")},null,null).exports,_={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"detailContent"},[s("div",{staticClass:"detailImage"},[s("img",{staticClass:"detailImageB",attrs:{src:t.data.image_lmobile}}),s("img",{staticClass:"detailImageS",attrs:{src:t.data.image}})]),t._v(" "),s("div",{staticClass:"datailContentInfo"},[s("div",{staticClass:"event-info"},[s("h1",[t._v(t._s(t.data.title))]),t._v(" "),s("p",[s("label",[t._v("时间：")]),t._v(t._s(t.data.begin_time)+" ~ "+t._s(t.data.end_time))]),t._v(" "),s("p",{staticClass:"tips"},[t._v("活动结束时间以实际活动为准")]),t._v(" "),s("p",[s("label",[t._v("地点：")]),t._v(t._s(t.data.address))]),t._v(" "),s("p",[s("label",[t._v("费用：")]),t._v(t._s(t.data.fee_str))]),t._v(" "),s("p",[s("label",[t._v("类型：")]),s("router-link",{attrs:{to:{path:"/typelist?type="+t.data.category}}},[t._v(t._s(t.data.category_name))])],1),t._v(" "),s("p",[s("span",[t._v(t._s(t.data.wisher_count)+" 人感兴趣")]),s("span",[t._v(t._s(t.data.participant_count)+" 人参加")])])]),t._v(" "),s("div",{staticClass:"related_info"},[s("h2",[t._v("活动详情")]),t._v(" "),s("div",{staticClass:"suggest",domProps:{innerHTML:t._s(t.content)}})])])])},staticRenderFns:[]};var C=s("VU/8")({data:function(){return{data:"",content:""}},created:function(){this.getId()},methods:{getId:function(){var t=this,e=this.$route.params.id;null!=e&&this.$http.jsonp("https://api.douban.com/v2/event/"+e,{}).then(function(e){t.data=e.data,t.content=e.data.content.replace(/http(\S*)s/g,"https://images.weserv.nl/?url=https")})}},watch:{$route:"getId"}},_,!1,function(t){s("qV6e")},null,null).exports,b={data:function(){return{citys:[],cityCn:"上海"}},created:function(){this.getCity()},methods:{getCity:function(){var t=this;this.$http.jsonp("https://api.douban.com/v2/loc/list",{params:{}}).then(function(e){t.citys=e.data.locs},function(t){console.log(t)})},sendCity:function(t,e){this.cityCn=e,this.$emit("cityName",{cityEn:t,cityCn:e}),this.$router.push({name:"Home"})}},watch:{$route:"getCity"}},w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"city"},[s("h2",[s("label",[t._v("当前定位城市：")]),t._v(t._s(t.cityCn))]),t._v(" "),s("p",[t._v("热门城市")]),t._v(" "),s("ol",t._l(t.citys,function(e,i){return i<14?s("li",{on:{click:function(s){t.sendCity(e.uid,e.name)}}},[t._v(t._s(e.name))]):t._e()}))])},staticRenderFns:[]};var L=s("VU/8")(b,w,!1,function(t){s("Pe/1")},"data-v-1c44e717",null).exports;i.default.use(p.a);var k=new p.a({routes:[{path:"/",name:"Home",component:f},{path:"/city",name:"City",component:L},{path:"/typelist",name:"TypeList",component:g},{path:"/detail/:id",name:"Detail",component:C}],scrollBehavior:function(t,e,s){return s||{x:0,y:0}}}),E=s("8+8L");i.default.use(l.a);var T=new l.a.Store({state:{loading:!1},mutations:{loading:function(t,e){t.loading=e}}});i.default.use(n.a),i.default.use(E.a),i.default.http.interceptors.push(function(t,e){var s=sessionStorage.getItem("STORAGE_TOKEN");s&&t.headers.set("TOKEN",s),T.commit("loading",!0),e(function(t){return T.commit("loading",!1),t})}),new i.default({el:"#app",router:k,store:T,components:{App:d},template:"<App/>"})},PGL6:function(t,e){},"Pe/1":function(t,e){},"Yz7+":function(t,e,s){t.exports=s.p+"static/img/banner.e3ed92d.png"},cBJ7:function(t,e){},kEhB:function(t,e){},ngOA:function(t,e){},qV6e:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.7a99f0dc30c194298f2e.js.map